<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>Shop Điện Thoại</title>
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/normalize/8.0.1/normalize.min.css" />
        <link rel="stylesheet" href="./assets/css/base.css" />
        <link rel="stylesheet" href="./assets/css/style.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&display=swap');
        </style>
    </head>
    <body>
        <div id="main">
            <header class="header">
                <div class="header__top">
                    <a href="index.html" class="header__top-logo">
                        <img class="header__top-logo-img" src="https://cdn.haitrieu.com/wp-content/uploads/2021/11/Logo-The-Gioi-Di-Dong-MWG-B-H.png" />
                    </a>
                    <div class="header__top-place">
                        <div class="header__top-place--left">
                            <p class="header__top-place-title">Xem giá, tồn kho tại:</p>
                            <p class="header__top-place-location">Hồ Chí Minh</p>
                        </div>
                        <div class="header__top-place--right">
                            <i class="header__top-place-icon fa-solid fa-caret-down"></i>
                        </div>
                    </div>
                    <div class="header__top-search">
                        <input type="text" class="header__top-search-input" placeholder="Bạn tìm gì..." />
                        <button class="header__top-search-btn">
                            <i class="fa-solid fa-magnifying-glass"></i>
                        </button>
                        <div class="header__top-search-result"></div>
                    </div>
                    <div class="header__top-oder-infor">
                        <p class="header__top-oder-infor-title">Tài khoản & Đơn hàng</p>
                    </div>
                    <a href="cart.html" class="header__top-cart" id="cart">
                        <i class="header__top-cart-icon fa-brands fa-opencart"></i>
                        <div class="header__top-cart-number"></div>
                        <p class="header__top-cart-title">Giỏ hàng</p>
                    </a>
                    <div class="header__top-news">
                        <p class="header__top-news-item">24h Công nghệ</p>
                        <div class="header__top-news-split"></div>
                        <p class="header__top-news-item">Hỏi Đáp</p>
                        <div class="header__top-news-split"></div>
                        <p class="header__top-news-item">Game App</p>
                    </div>
                </div>
                <ul class="nav__items">
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-mobile-screen"></i>
                            <p class="nav__item-title">Điện thoại</p>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-laptop"></i>
                            <p class="nav__item-title">Laptop</p>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-tablet-screen-button"></i>
                            <p class="nav__item-title">Tablet</p>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-headphones"></i>
                            <p class="nav__item-title">Phụ kiện</p>
                            <i class="nav__item-icon fa-solid fa-caret-down"></i>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-stopwatch"></i>
                            <p class="nav__item-title">Smartwatch</p>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-clock"></i>
                            <p class="nav__item-title">Đồng hồ</p>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-mobile-screen"></i>
                            <p class="nav__item-title">Máy cũ giá rẻ</p>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <i class="nav__item-icon fa-solid fa-desktop"></i>
                            <p class="nav__item-title">Pc, Máy in</p>
                            <i class="nav__item-icon fa-solid fa-caret-down"></i>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <p class="nav__item-title">Sim, Thẻ cào</p>
                        </a>
                    </li>
                    <li class="nav__item">
                        <a href="#" class="nav__item-link">
                            <p class="nav__item-title">Dịch vụ tiện ích</p>
                            <i class="nav__item-icon fa-solid fa-caret-down"></i>
                        </a>
                    </li>
                </ul>
            </header>
            <div class="cart--empty">
                <i class="cart-icon fa-solid fa-cart-arrow-down"></i>
                <p class="cart-title">Không có sản phẩm nào trong giỏ hàng</p>
                <a href="index.html" class="backhome">VỀ TRANG CHỦ</a>
            </div>
            <div class="cart"></div>
            <div class="customer">
                <p class="customer__title">THÔNG TIN KHÁCH HÀNG</p>
                <div class="customer__sex">
                    <label class="container"
                        >Nam
                        <input name="gender" value="Nam" class="checkbox" type="checkbox" onclick="handleChecked(0)" checked="true" />
                        <span class="checkmark"></span>
                    </label>
                    <label class="container"
                        >Nữ
                        <input name="gender" value="Nữ" class="checkbox" type="checkbox" onclick="handleChecked(1)" />
                        <span class="checkmark"></span>
                    </label>
                </div>
                <form class="form" id="form-1">
                    <div class="form-input">
                        <div class="form-group">
                            <label for="fullname" class="form-label"></label>
                            <input maxlength="30" id="fullname" name="fullname" rules="required|name|max:30" class="form-control" type="text" placeholder="Họ và Tên" />
                            <span class="form-message"></span>
                        </div>
                        <div class="form-group">
                            <label for="phonenumber" class="form-label"></label>
                            <input maxlength="10" minlength="10" id="phonenumber" name="phonenumber" rules="required|number|min:10" class="form-control" type="text" placeholder="Số điện thoại" />
                            <span class="form-message"></span>
                        </div>
                    </div>
                    <div class="form-input">
                        <div class="form-group">
                            <label for="address" class="form-label"></label>
                            <input maxlength="100" minlength="10" id="address" name="address" rules="required" class="form-control" type="text" placeholder="Địa chỉ" />
                            <span class="form-message"></span>
                        </div>
                    </div>
                    <button class="form-submit">Mua hàng</button>
                </form>
            </div>
            <section style="position: fixed; bottom: 0; margin-top: 32px; width: 100vw; height: 32px; background-color: #eee"><p style="text-align: center; line-height: 32px">Copyright2023@PhamHungXuanSang,LeQuangPhuoc</p></section>
        </div>
    </body>
    <script type="module" src="./cart.js"></script>
    <script src="./validator.js"></script>
    <script>
        var form = new Validator('#form-1');
        form.onSubmit = (data) => {
            var inputs = document.querySelectorAll('input[name="gender"]');
            for (var input of inputs) {
                if (input.checked) {
                    data[input.name] = input.value;
                }
            }
            var cartInfo = JSON.parse(localStorage.getItem('CartData'));
            data['purchaseinfor'] = [];
            cartInfo.forEach((cI) => {
                var phoneInfo = {};
                phoneInfo['name'] = cI.name;
                phoneInfo['price'] = cI.newPrice;
                phoneInfo['quantity'] = cI.quantity;
                phoneInfo['intoMoney'] = cI.quantity * cI.newPrice;
                data['purchaseinfor'].push(phoneInfo);
            });
            // console.log(data);
            let sum = 0;
            let overlay = document.createElement('div');
            overlay.classList.add('overlay');
            // overlay.style = 'position:fixed;top:0;left:0;right:0;bottom:0;background-color:rgba(0,0,0,0.4);';
            overlay.innerHTML = `<div class='bill'>
                    <h2 class='bill-shop-name'>Shop Điện Thoại</h2>
                    <h3 style='text-align:center;margin:16px 0;color:#ccc;'>Cảm ơn Quý khách!</h3>
                    <h4 class='bill-shop-label'>Hoá đơn thanh toán</h4>
                    <p class='bill-shop-info'>Ngày mua hàng: ${new Date().getDate()}/${new Date().getMonth() + 1}/${new Date().getFullYear()}</p>
                    <p class='bill-shop-info'>Khách hàng: ${data.gender == 'Nam' ? 'Anh ' : 'Chị '}${data.fullname}</p>
                    <p class='bill-shop-info'>${data.phonenumber ? 'Số điện thoại: ' : ''}${data.phonenumber}</p>
                    <p class='bill-shop-info'>${data.address ? 'Địa chỉ: ' : ''}${data.address}</p>
                    <table style='border: 1px solid #ddd;width:100%;'>
                        <tr style='border: 1px solid #ddd;'>
                            <th style='border: 1px solid #ddd;'>STT</th>
                            <th style='border: 1px solid #ddd;'>Tên Hàng</th>
                            <th style='border: 1px solid #ddd;'>Đơn Giá</th>
                            <th style='border: 1px solid #ddd;'>Số Lượng</th>
                            <th style='border: 1px solid #ddd;'>Thành Tiền</th>
                        </tr>
                        ${data.purchaseinfor
                            .map((phone, index) => {
                                sum += phone.intoMoney;
                                return `<tr style='border: 1px solid #ddd;'>
                                    <th style='border: 1px solid #ddd;'>${index + 1}</th>
                                    <th style='border: 1px solid #ddd;'>${phone.name}</th>
                                    <th style='border: 1px solid #ddd;'>${phone.price.toLocaleString()}</th>
                                    <th style='border: 1px solid #ddd;'>${phone.quantity}</th>
                                    <th style='border: 1px solid #ddd;'>${phone.intoMoney.toLocaleString()}</th>
                                </tr>`;
                            })
                            .join('')}
                    </table>
                        <h3 style='margin-top:8px;text-align:right;margin:16px 0;'>Tổng tiền: ${sum.toLocaleString()} đ</h3>
                    <div style='text-align:right;'><button class="bill-confirm" onclick="closeForm()">Xác Nhận</button></div>
                </div>`;
            document.querySelector('body').appendChild(overlay);
        };
    </script>
</html>
